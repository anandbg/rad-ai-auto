---
phase: 15-template-creation-ux-overhaul
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/package.json
  - app/components/template-builder/sortable-section.tsx
  - app/components/template-builder/section-list.tsx
autonomous: true

must_haves:
  truths:
    - "Sections can be dragged to reorder them"
    - "Keyboard users can reorder with arrow keys"
    - "Screen readers announce drag operations"
  artifacts:
    - path: "app/components/template-builder/sortable-section.tsx"
      provides: "dnd-kit sortable wrapper for template sections"
      min_lines: 40
    - path: "app/components/template-builder/section-list.tsx"
      provides: "DndContext and SortableContext wrapper"
      exports: ["SectionList"]
      min_lines: 60
  key_links:
    - from: "section-list.tsx"
      to: "sortable-section.tsx"
      via: "renders SortableSection for each section"
      pattern: "SortableSection"
---

<objective>
Install drag-drop dependencies and create reusable section reordering components.

Purpose: Enable section reordering in template builder with accessible drag-drop.
Output: @dnd-kit installed, SortableSection and SectionList components ready for integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Research findings for dnd-kit patterns
@.planning/phases/15-template-creation-ux-overhaul/15-RESEARCH.md

# Existing template structure
@app/lib/validation/template-schema.ts

# Motion variants for animations
@app/lib/motion/variants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @dnd-kit dependencies</name>
  <files>app/package.json</files>
  <action>
    Run: cd app && pnpm add @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities

    The @dnd-kit packages provide:
    - @dnd-kit/core: DndContext, sensors, collision detection
    - @dnd-kit/sortable: useSortable hook, SortableContext, arrayMove
    - @dnd-kit/utilities: CSS.Transform for smooth animations

    Do NOT install react-beautiful-dnd (deprecated) or react-dnd (more complex).
  </action>
  <verify>cd app && pnpm list @dnd-kit/core @dnd-kit/sortable shows packages installed</verify>
  <done>@dnd-kit packages installed in app/package.json</done>
</task>

<task type="auto">
  <name>Task 2: Create SortableSection component</name>
  <files>app/components/template-builder/sortable-section.tsx</files>
  <action>
    Create new file app/components/template-builder/sortable-section.tsx.

    Component requirements:
    1. Use useSortable hook from @dnd-kit/sortable
    2. Accept props: id, section (TemplateSection), onUpdate, onRemove
    3. Apply transform and transition styles from useSortable
    4. Include drag handle button with GripVertical icon (from lucide-react)
    5. Set opacity to 0.5 when isDragging
    6. Use existing Input/Textarea components for section name/content
    7. Include Remove button (calls onRemove)
    8. Add aria-label on drag handle: "Drag to reorder section"

    Pattern from research:
    ```typescript
    const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id });
    const style = {
      transform: CSS.Transform.toString(transform),
      transition,
      opacity: isDragging ? 0.5 : 1,
    };
    ```

    Import TemplateSection type from @/lib/validation/template-schema.
    Use existing Card component for section container styling.
  </action>
  <verify>TypeScript compiles: cd app && npx tsc --noEmit</verify>
  <done>SortableSection component exports and accepts TemplateSection props</done>
</task>

<task type="auto">
  <name>Task 3: Create SectionList component with DndContext</name>
  <files>app/components/template-builder/section-list.tsx</files>
  <action>
    Create new file app/components/template-builder/section-list.tsx.

    Component requirements:
    1. Wrap content in DndContext with PointerSensor and KeyboardSensor
    2. Use SortableContext with verticalListSortingStrategy
    3. Accept props: sections, onReorder, onUpdateSection, onRemoveSection
    4. Map over sections, render SortableSection for each
    5. Handle onDragEnd with arrayMove helper
    6. Include accessible announcements object for screen readers

    Announcements pattern from research:
    ```typescript
    const announcements = {
      onDragStart({ active }) {
        return `Picked up section ${active.data.current?.name}. Use arrow keys to move.`;
      },
      onDragEnd({ active, over }) {
        if (over) {
          return `Section ${active.data.current?.name} was dropped at position ${over.data.current?.sortable.index + 1}`;
        }
        return `Section ${active.data.current?.name} was dropped`;
      },
      // ... other announcements
    };
    ```

    Use closestCenter collision detection.
    Export SectionList as named export.
  </action>
  <verify>TypeScript compiles: cd app && npx tsc --noEmit</verify>
  <done>SectionList renders sortable sections with keyboard and mouse support</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd app && pnpm list @dnd-kit/core` shows version installed
- [ ] `cd app && npx tsc --noEmit` passes
- [ ] SortableSection component exists with useSortable hook
- [ ] SectionList component exists with DndContext and sensors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- dnd-kit packages installed
- Components export correctly and TypeScript passes
</success_criteria>

<output>
After completion, create `.planning/phases/15-template-creation-ux-overhaul/15-01-SUMMARY.md`
</output>
